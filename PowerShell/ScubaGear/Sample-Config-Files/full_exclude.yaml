Description: |
  YAML Configuration file with all parameters
  This config file does not include any custom variables or any per product namespace variables.  The file shows all global configuration file variables with their default values .  Users can override these values as needed.  Global variables can be omitted from the file if the default is desired.  Global variables specified in the configuration file can also be overridden if given as command line parameters.
  For more specific per product config variables please refer to the sample config associated with that product
  This example includes the following design choices for illustrative purposes:
  - Use of Pascal case convention for variable names
ProductNames: ['*']
M365Environment: commercial
LogIn: true
DisconnectOnExit: false
OutPath: .
OutFolderName: M365BaselineConformance
OutProviderFileName: ProviderSettingsExport
OutRegoFileName: TestResults
OutReportName: BaselineReports
Organization: abcdef.example.com
AppID: 0123456789abcdef01234566789abcde
CertificateThumbprint: fedcba9876543210fedcba9876543210fedcba98
OutJsonFileName: ScubaResults
OutCsvFileName: ScubaResults
OutActionPlanFileName: ActionPlan
##======================
## EXCLUSIONS : AAD
##======================
# This is for the Azure Active Directory product
Aad:
  # Legacy authentication SHALL be blocked.
  MS.AAD.1.1v1: &OrgCapExclusions
    CapExclusions:
      Groups:
        - 1a0161f4-318c-4415-b2a0-862bde2c9cde # Example Group
      Users:
        - 9d9ac7b2-5aa6-4830-a17a-6557e52140b0 # Example User
  # Users detected as high risk SHALL be blocked.
  MS.AAD.2.1v1: &OrgCapExclusions
    CapExclusions:
      Groups:
        - 1a0161f4-318c-4415-b2a0-862bde2c9cde # Example Group
      Users:
        - 9d9ac7b2-5aa6-4830-a17a-6557e52140b0 # Example User
  # Sign-ins detected as high risk SHALL be blocked.
  MS.AAD.2.3v1: &OrgCapExclusions
    CapExclusions:
      Groups:
        - 1a0161f4-318c-4415-b2a0-862bde2c9cde # Example Group
      Users:
        - 9d9ac7b2-5aa6-4830-a17a-6557e52140b0 # Example User
  # Phishing-resistant MFA SHALL be enforced for all users.
  MS.AAD.3.1v1: &OrgCapExclusions
    CapExclusions:
      Groups:
        - 1a0161f4-318c-4415-b2a0-862bde2c9cde # Example Group
      Users:
        - 9d9ac7b2-5aa6-4830-a17a-6557e52140b0 # Example User
  # If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users.
  MS.AAD.3.2v1: &OrgCapExclusions
    CapExclusions:
      Groups:
        - 1a0161f4-318c-4415-b2a0-862bde2c9cde # Example Group
      Users:
        - 9d9ac7b2-5aa6-4830-a17a-6557e52140b0 # Example User
  #Phishing-resistant MFA SHALL be required for highly privileged roles.
  MS.AAD.3.6v1: &OrgCapExclusions
    CapExclusions:
      Groups:
        - 1a0161f4-318c-4415-b2a0-862bde2c9cde # Example Group
      Users:
        - 9d9ac7b2-5aa6-4830-a17a-6557e52140b0 # Example User
  # Managed devices SHOULD be required for authentication.
  MS.AAD.3.7v1: &OrgCapExclusions
    CapExclusions:
      Groups:
        - 1a0161f4-318c-4415-b2a0-862bde2c9cde # Example Group
      Users:
        - 9d9ac7b2-5aa6-4830-a17a-6557e52140b0 # Example User
  #Managed Devices SHOULD be required to register MFA
  MS.AAD.3.8v1: &OrgCapExclusions
    CapExclusions:
      Groups:
        - 1a0161f4-318c-4415-b2a0-862bde2c9cde # Example Group
      Users:
        - 9d9ac7b2-5aa6-4830-a17a-6557e52140b0 # Example User
  #Deviceflow block SHALL be enforced for all users.
  MS.AAD.3.9v1: &OrgCapExclusions
    CapExclusions:
      Groups:
        - 1a0161f4-318c-4415-b2a0-862bde2c9cde # Example Group
      Users:
        - 9d9ac7b2-5aa6-4830-a17a-6557e52140b0 # Example User
  #Permanent active role assignments SHALL NOT be allowed for highly privileged roles.
  MS.AAD.7.4v1: &OrgRolesExclusions
    PrivilegedRoleExclusions:
      Roles:
        - Global Administrator
        - Privileged Role Administrator
        - Exchange Administrator
        - SharePoint Administrator
        - Teams Administrator
##======================
## EXCLUSIONS : DEFENDER
##======================
# This is for the Defender product
Defender:
  MS.DEFENDER.1.4v1: &CommonSensitiveAccountFilter
    # Defines sensitive accounts filters used to select accounts to assign to
    # the Strict Preset Security Policy for Exchange Online Protections
    # Values for each key should match those shown in the 'Apply Exchange
    # Online Protection' section of the manage protection settings dialog.
    SensitiveAccounts:
      IncludedUsers:
        - johndoe@random.example.com
      IncludedGroups:
        - Dune
      IncludedDomains:
        - random.mail.example.com
      ExcludedUsers:
        -
      ExcludedGroups:
        -
      ExcludedDomains:
        -
  MS.DEFENDER.1.5v1:
    *CommonSensitiveAccountFilter
    # Defines sensitive accounts filters used to select accounts to assign to
    # the Strict Preset Security Policy for Defender for Office 365.
    # Values for each key should match those shown in the 'Apply Defender for
    # Office 365 protection' section of the manage protection settings dialog.
    # Note:  This example uses a YAML alias to re-use MS.DEFENDER.1.4v1 values
  MS.DEFENDER.2.1v1: &UserImpersonationProtection
    # Defines sensitive user accounts by display name and email address in
    # the Strict and Standard Preset Security Policies impersonation
    # protection section.
    # Each value should be a string in the form of the display name and
    # email address separated by a semicolon.
    SensitiveUsers:
      - John Doe;jdoe@someemail.com
  MS.DEFENDER.2.2v1: &AgencyDomainImpersonationProtection
    # Defines a list of agency domain names that should be specified
    # in the Strict and Standard Preset Security Policies impersonation
    # protection section.
    AgencyDomains:
      - random.mail.example.com
  MS.DEFENDER.2.3v1: &PartnerDomainImpersonationProtection
    # Defines a list of frequent partner domain names that should be
    # specified in the Strict and Standard Preset Security Policies
    # impersonation protection section.
    PartnerDomains:
      - random.mail.example.com
##======================
## EXCLUSIONS : EXO
##======================
# This is for the Exchange Online product
Exo:
  MS.EXO.1.1v2:
    AllowedForwardingDomains:
      - example1.com
      - example2.com
